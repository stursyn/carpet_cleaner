<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd">

  <changeSet author="maxim" id="create-function-moment">
    <sql endDelimiter=";;"><![CDATA[
      create function moment() returns timestamp
      language plpgsql as 'begin return clock_timestamp(); end ' ;;


      create table service_last_result(
        hash varchar(40) primary key,
        value jsonb,
        created_at timestamp not null default clock_timestamp()
      );;



      create table sms_log(
        message_id varchar(255) not null,
        to_phone varchar(100),
        from_phone varchar(100),
        body varchar(100),
        status varchar(100),
        error_code varchar(100),
        error_message text
       );

    ]]></sql>
  </changeSet>

  <changeSet author="rbayakhmetov" id="change-hash-size">
    <sql>
      <![CDATA[
      alter table service_last_result alter column hash type text using hash::text;
    ]]>
    </sql>
  </changeSet>

</databaseChangeLog>
